{"last_node_id":144,"last_link_id":251,"nodes":[{"id":66,"type":"Cfg Literal","pos":[50,1370],"size":{"0":320,"1":60},"flags":{},"order":0,"mode":0,"outputs":[{"name":"FLOAT","type":"FLOAT","links":[112],"slot_index":0,"shape":3,"label":"FLOAT"}],"title":"Face Detail cfg","properties":{"Node name for S&R":"Cfg Literal"},"widgets_values":[4],"color":"#86103b","bgcolor":"#9a244f"},{"id":137,"type":"Note","pos":[2210,1470],"size":{"0":310,"1":400},"flags":{},"order":1,"mode":0,"properties":{"text":""},"widgets_values":["Makeup Layers refers to the number of times the detailer layers your makeup.  Four is a good starting point.\n\nKeep in mind that the more layers you use, the more the face will drift from true.\n\nChange the seed for slightly different makeup styling.\n\n"],"color":"#a51949","bgcolor":"#b92d5d"},{"id":138,"type":"Note","pos":[50,1490],"size":{"0":310,"1":400},"flags":{},"order":2,"mode":0,"properties":{"text":""},"widgets_values":["The secret of this workflow is that we're using very low step and cfg setting, but we're repeating it multiple times.  This allows us to layer on makeup without the face drifting too far from the original.  There will always be some drift, however.\n\n"],"color":"#a51949","bgcolor":"#b92d5d"},{"id":112,"type":"Note","pos":[2620,900],"size":{"0":650,"1":330},"flags":{},"order":3,"mode":0,"properties":{"text":""},"widgets_values":["I sometimes get an out of memory error when I change checkpoints.  Hitting Queue again fixes the issue and starts the process.\n\nWorks best on female faces, it's apparently a built in bias in the models.\n\nComplex backgrounds can confuse The Machine.\n\nFreckles get powdered over. It seems The Machine likes a heavy foundation."],"color":"#a10600","bgcolor":"#b51a00"},{"id":139,"type":"Note","pos":[1540,420],"size":{"0":1090,"1":410},"flags":{},"order":4,"mode":0,"properties":{"text":""},"widgets_values":["This is just a doodle I through together today that sprang out of a much more complex project I was working on.  I just found myself suddenly inspired when I realized how easy this would be to do.\n\nIf you've not updated your ComfyUI lately, you may need to Update All from the Manager.  In order to work the FaceDetailer needs to have Cycles available.  \n\nAs this is only a doodle, it's not 100% accurate and you may find yourself needing to tweak your makeup descriptions or applying more layers.  However, it's still fun to play with.\n\nI hope you enjoy playing with it as much as I've enjoyed tossing it together.\n\n--Clark Glenn Davis, aka Verevolf\n\nOh, the demo images I used were all licensed from Adobe."],"color":"#000a43","bgcolor":"#001e57"},{"id":135,"type":"CLIPTextEncode","pos":[2200,900],"size":{"0":350,"1":220},"flags":{},"order":14,"mode":0,"inputs":[{"name":"clip","type":"CLIP","link":235,"label":"CLIP"}],"outputs":[{"name":"CONDITIONING","type":"CONDITIONING","links":[240],"slot_index":0,"shape":3,"label":"条件"}],"properties":{"Node name for S&R":"CLIPTextEncode"},"widgets_values":["",true],"color":"#6f0000","bgcolor":"#831100"},{"id":22,"type":"UltralyticsDetectorProvider","pos":[45.04017819580079,991.8948987304689],"size":{"0":320,"1":80},"flags":{"collapsed":false},"order":5,"mode":0,"outputs":[{"name":"BBOX_DETECTOR","type":"BBOX_DETECTOR","links":[186],"slot_index":0,"shape":3,"label":"BBox检测"},{"name":"SEGM_DETECTOR","type":"SEGM_DETECTOR","links":[],"slot_index":1,"shape":3,"label":"SEGM检测"}],"properties":{"Node name for S&R":"UltralyticsDetectorProvider"},"widgets_values":["bbox/face_yolov8n_v2.pt"],"color":"#86103b","bgcolor":"#9a244f"},{"id":12,"type":"CheckpointLoaderSimple","pos":[996.013456354622,906.5240012173234],"size":{"0":510,"1":100},"flags":{},"order":6,"mode":0,"outputs":[{"name":"MODEL","type":"MODEL","links":[228],"slot_index":0,"shape":3,"label":"模型"},{"name":"CLIP","type":"CLIP","links":[232,235,237],"slot_index":1,"shape":3,"label":"CLIP"},{"name":"VAE","type":"VAE","links":[26],"slot_index":2,"shape":3,"label":"VAE"}],"properties":{"Node name for S&R":"CheckpointLoaderSimple"},"widgets_values":["sd1.5/dreamshaper_8.safetensors"],"color":"#280007","bgcolor":"#3c081b"},{"id":52,"type":"Sampler Selector","pos":[996.013456354622,1046.5240012173228],"size":{"0":270,"1":60},"flags":{},"order":7,"mode":0,"outputs":[{"name":"sampler_name","type":"COMBO","links":[79],"slot_index":0,"shape":3,"label":"sampler_name"}],"properties":{"Node name for S&R":"Sampler Selector"},"widgets_values":["dpmpp_sde"],"color":"#280007","bgcolor":"#3c081b"},{"id":1,"type":"LoadImage","pos":[900,1180],"size":{"0":620,"1":600},"flags":{},"order":8,"mode":0,"outputs":[{"name":"IMAGE","type":"IMAGE","links":[56],"slot_index":0,"shape":3,"label":"图像"},{"name":"MASK","type":"MASK","links":null,"shape":3,"label":"遮罩"}],"properties":{"Node name for S&R":"LoadImage"},"widgets_values":["003.png","image"],"color":"#5b6200","bgcolor":"#6f7608"},{"id":65,"type":"Int Literal","pos":[50,1260],"size":{"0":320,"1":60},"flags":{},"order":9,"mode":0,"outputs":[{"name":"INT","type":"INT","links":[111],"slot_index":0,"shape":3,"label":"INT"}],"title":"Face Detail Steps","properties":{"Node name for S&R":"Int Literal"},"widgets_values":[2],"color":"#86103b","bgcolor":"#9a244f"},{"id":23,"type":"SAMLoader","pos":[30,1130],"size":{"0":320,"1":82},"flags":{"pinned":false},"order":10,"mode":0,"outputs":[{"name":"SAM_MODEL","type":"SAM_MODEL","links":[184],"slot_index":0,"shape":3,"label":"SAM模型"}],"properties":{"Node name for S&R":"SAMLoader"},"widgets_values":["sam_vit_b_01ec64.pth","Prefer GPU"],"color":"#86103b","bgcolor":"#9a244f"},{"id":143,"type":"ImpactSchedulerAdapter","pos":[-400,970],"size":[220,60],"flags":{},"order":16,"mode":0,"inputs":[{"name":"scheduler","type":"COMBO","link":250,"widget":{"name":"scheduler"}}],"outputs":[{"name":"scheduler","type":"COMBO","links":[249],"shape":3,"label":"scheduler"}],"properties":{"Node name for S&R":"ImpactSchedulerAdapter"},"widgets_values":["normal","AYS SD1"]},{"id":144,"type":"Scheduler Selector","pos":[-810,1030],"size":{"0":315,"1":58},"flags":{},"order":11,"mode":0,"outputs":[{"name":"scheduler","type":"COMBO","links":[250],"shape":3,"label":"scheduler"}],"properties":{"Node name for S&R":"Scheduler Selector"},"widgets_values":["karras"]},{"id":21,"type":"FaceDetailer","pos":[380,920],"size":{"0":490,"1":1040},"flags":{},"order":17,"mode":0,"inputs":[{"name":"image","type":"IMAGE","link":56,"label":"图像"},{"name":"model","type":"MODEL","link":228,"label":"模型"},{"name":"clip","type":"CLIP","link":232,"label":"CLIP"},{"name":"vae","type":"VAE","link":26,"label":"VAE"},{"name":"positive","type":"CONDITIONING","link":239,"label":"正面条件"},{"name":"negative","type":"CONDITIONING","link":240,"label":"负面条件"},{"name":"bbox_detector","type":"BBOX_DETECTOR","link":186,"label":"BBox检测"},{"name":"sam_model_opt","type":"SAM_MODEL","link":184,"label":"SAM模型"},{"name":"segm_detector_opt","type":"SEGM_DETECTOR","link":null,"label":"Segm检测"},{"name":"detailer_hook","type":"DETAILER_HOOK","link":null,"label":"细化约束"},{"name":"sampler_name","type":"COMBO","link":79,"widget":{"name":"sampler_name"},"label":"采样器"},{"name":"scheduler","type":"COMBO","link":249,"widget":{"name":"scheduler"},"label":"调度器"},{"name":"steps","type":"INT","link":111,"widget":{"name":"steps"},"label":"步数"},{"name":"cfg","type":"FLOAT","link":112,"widget":{"name":"cfg"},"label":"CFG"},{"name":"seed","type":"INT","link":160,"widget":{"name":"seed"},"label":"随机种"},{"name":"cycle","type":"INT","link":248,"widget":{"name":"cycle"}}],"outputs":[{"name":"image","type":"IMAGE","links":[224],"slot_index":0,"shape":3,"label":"图像"},{"name":"cropped_refined","type":"IMAGE","links":[],"slot_index":1,"shape":6,"label":"细化图像"},{"name":"cropped_enhanced_alpha","type":"IMAGE","links":[],"slot_index":2,"shape":6,"label":"细化部分"},{"name":"mask","type":"MASK","links":[],"slot_index":3,"shape":3,"label":"遮罩"},{"name":"detailer_pipe","type":"DETAILER_PIPE","links":null,"shape":3,"label":"细化节点束"},{"name":"cnet_images","type":"IMAGE","links":null,"shape":6,"label":"ControlNet图像"}],"properties":{"Node name for S&R":"FaceDetailer"},"widgets_values":[512,true,768,1052570527455683,"fixed",14,4,"euler_ancestral","normal",0.3,5,true,true,0.5,10,3,"center-1",0,0.93,6,0.7,"False",10,"",1,false,20,true],"color":"#86103b","bgcolor":"#9a244f"},{"id":134,"type":"PreviewImage","pos":[1550,1180],"size":{"0":620,"1":610},"flags":{},"order":18,"mode":0,"inputs":[{"name":"images","type":"IMAGE","link":224,"label":"图像"}],"properties":{"Node name for S&R":"PreviewImage"}},{"id":136,"type":"CLIPTextEncode","pos":[1540,900],"size":{"0":620,"1":220},"flags":{},"order":15,"mode":0,"inputs":[{"name":"clip","type":"CLIP","link":237,"label":"CLIP"}],"outputs":[{"name":"CONDITIONING","type":"CONDITIONING","links":[239],"slot_index":0,"shape":3,"label":"条件"}],"properties":{"Node name for S&R":"CLIPTextEncode"},"widgets_values":["vibrant red lipstick, black eyeliner",true],"color":"#3b6614","bgcolor":"#4f7a28"},{"id":98,"type":"Seed Generator","pos":[2205.8313349218774,1333.7730782324227],"size":{"0":315,"1":82},"flags":{},"order":12,"mode":0,"outputs":[{"name":"INT","type":"INT","links":[160],"slot_index":0,"shape":3,"label":"INT"}],"title":"Face Detail Seed","properties":{"Node name for S&R":"Seed Generator"},"widgets_values":[743427032616292,"randomize"],"color":"#86103b","bgcolor":"#9a244f"},{"id":141,"type":"Int Literal","pos":[2200,1220],"size":{"0":320,"1":60},"flags":{},"order":13,"mode":0,"outputs":[{"name":"INT","type":"INT","links":[248],"slot_index":0,"shape":3,"label":"INT"}],"title":"Makeup Layers","properties":{"Node name for S&R":"Int Literal"},"widgets_values":[4],"color":"#86103b","bgcolor":"#9a244f"}],"links":[[26,12,2,21,3,"VAE"],[56,1,0,21,0,"IMAGE"],[79,52,0,21,10,"COMBO"],[111,65,0,21,12,"INT"],[112,66,0,21,13,"FLOAT"],[160,98,0,21,14,"INT"],[184,23,0,21,7,"SAM_MODEL"],[186,22,0,21,6,"BBOX_DETECTOR"],[224,21,0,134,0,"IMAGE"],[228,12,0,21,1,"MODEL"],[232,12,1,21,2,"CLIP"],[235,12,1,135,0,"CLIP"],[237,12,1,136,0,"CLIP"],[239,136,0,21,4,"CONDITIONING"],[240,135,0,21,5,"CONDITIONING"],[248,141,0,21,15,"INT"],[249,143,0,21,11,"COMBO"],[250,144,0,143,0,"COMBO"]],"groups":[{"title":"Makeup Applicator","bounding":[2177,1149,364,735],"color":"#d95d8a","font_size":24,"locked":false},{"title":"Initial Choices","bounding":[984,834,534,291],"color":"#d95d8a","font_size":24,"locked":false},{"title":"The Makeup Counter","bounding":[33,801,845,1136],"color":"#d95d8a","font_size":24,"locked":false}],"config":{},"extra":{"workspace_info":{"id":"ZFsFakfGyg-OhA2R6B1FG","saveLock":false,"cloudID":null,"coverMediaPath":null},"ds":{"scale":0.7400249944258223,"offset":[-855.8339406429817,-913.1814497464633]}},"version":0.4}