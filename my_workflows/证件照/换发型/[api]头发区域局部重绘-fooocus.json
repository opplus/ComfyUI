{"last_node_id":312,"last_link_id":786,"nodes":[{"id":128,"type":"Reroute","pos":[-1780,560],"size":[75,26],"flags":{},"order":6,"mode":0,"inputs":[{"name":"","type":"*","link":782}],"outputs":[{"name":"","type":"IMAGE","links":[477,481,501,746,778],"slot_index":0}],"properties":{"showOutputText":false,"horizontal":false}},{"id":191,"type":"ImageToMask","pos":[-460,930],"size":{"0":370,"1":60},"flags":{},"order":19,"mode":0,"inputs":[{"name":"image","type":"IMAGE","link":750,"label":"图像"}],"outputs":[{"name":"MASK","type":"MASK","links":[779],"slot_index":0,"shape":3,"label":"遮罩"}],"properties":{"Node name for S&R":"ImageToMask"},"widgets_values":["red"]},{"id":208,"type":"LayerMask: PersonMaskUltra V2","pos":[-1640,610],"size":{"0":315,"1":414},"flags":{},"order":8,"mode":0,"inputs":[{"name":"images","type":"IMAGE","link":477,"label":"图像"}],"outputs":[{"name":"image","type":"IMAGE","links":[],"slot_index":0,"shape":3,"label":"图像"},{"name":"mask","type":"MASK","links":[489],"slot_index":1,"shape":3,"label":"遮罩"}],"properties":{"Node name for S&R":"LayerMask: PersonMaskUltra V2"},"widgets_values":[true,true,false,false,false,false,0.3,"VITMatte",1,6,0.01,0.99,true,"cuda",2]},{"id":210,"type":"MaskToImage","pos":[-1270,830],"size":{"0":300,"1":30},"flags":{},"order":15,"mode":0,"inputs":[{"name":"mask","type":"MASK","link":488,"label":"遮罩"}],"outputs":[{"name":"IMAGE","type":"IMAGE","links":[748],"slot_index":0,"shape":3,"label":"图像"}],"properties":{"Node name for S&R":"MaskToImage"}},{"id":211,"type":"LayerMask: PersonMaskUltra V2","pos":[-1650,1100],"size":{"0":315,"1":414},"flags":{},"order":9,"mode":0,"inputs":[{"name":"images","type":"IMAGE","link":481,"label":"图像"}],"outputs":[{"name":"image","type":"IMAGE","links":[],"slot_index":0,"shape":3,"label":"图像"},{"name":"mask","type":"MASK","links":[490],"slot_index":1,"shape":3,"label":"遮罩"}],"properties":{"Node name for S&R":"LayerMask: PersonMaskUltra V2"},"widgets_values":[false,true,false,false,false,false,0.3,"VITMatte",1,6,0.01,0.99,true,"cuda",2]},{"id":216,"type":"MaskFix+","pos":[-1280,620],"size":{"0":315,"1":154},"flags":{},"order":12,"mode":0,"inputs":[{"name":"mask","type":"MASK","link":489,"label":"mask"}],"outputs":[{"name":"MASK","type":"MASK","links":[488],"slot_index":0,"shape":3,"label":"MASK"}],"properties":{"Node name for S&R":"MaskFix+"},"widgets_values":[0,20,0,0,0]},{"id":217,"type":"MaskFix+","pos":[-1280,1110],"size":{"0":315,"1":154},"flags":{},"order":13,"mode":0,"inputs":[{"name":"mask","type":"MASK","link":490,"label":"mask"}],"outputs":[{"name":"MASK","type":"MASK","links":[491],"slot_index":0,"shape":3,"label":"MASK"}],"properties":{"Node name for S&R":"MaskFix+"},"widgets_values":[0,0,0,0,0]},{"id":218,"type":"MaskToImage","pos":[-1270,1320],"size":{"0":310,"1":30},"flags":{},"order":16,"mode":0,"inputs":[{"name":"mask","type":"MASK","link":491,"label":"遮罩"}],"outputs":[{"name":"IMAGE","type":"IMAGE","links":[749],"slot_index":0,"shape":3,"label":"图像"}],"properties":{"Node name for S&R":"MaskToImage"}},{"id":220,"type":"LayerMask: PersonMaskUltra V2","pos":[-1640,1580],"size":{"0":315,"1":414},"flags":{},"order":10,"mode":0,"inputs":[{"name":"images","type":"IMAGE","link":501,"label":"图像"}],"outputs":[{"name":"image","type":"IMAGE","links":[],"slot_index":0,"shape":3,"label":"图像"},{"name":"mask","type":"MASK","links":[500],"slot_index":1,"shape":3,"label":"遮罩"}],"properties":{"Node name for S&R":"LayerMask: PersonMaskUltra V2"},"widgets_values":[true,true,true,true,true,false,0.4,"VITMatte",6,6,0.01,0.99,true,"cuda",2]},{"id":221,"type":"MaskFix+","pos":[-1260,1590],"size":{"0":315,"1":154},"flags":{},"order":14,"mode":0,"inputs":[{"name":"mask","type":"MASK","link":500,"label":"mask"}],"outputs":[{"name":"MASK","type":"MASK","links":[499],"slot_index":0,"shape":3,"label":"MASK"}],"properties":{"Node name for S&R":"MaskFix+"},"widgets_values":[0,0,0,0,0]},{"id":222,"type":"MaskToImage","pos":[-1250,1800],"size":{"0":310,"1":30},"flags":{},"order":17,"mode":0,"inputs":[{"name":"mask","type":"MASK","link":499,"label":"遮罩"}],"outputs":[{"name":"IMAGE","type":"IMAGE","links":[747],"slot_index":0,"shape":3,"label":"图像"}],"properties":{"Node name for S&R":"MaskToImage"}},{"id":256,"type":"Reroute","pos":[200,600],"size":[75,26],"flags":{},"order":5,"mode":0,"inputs":[{"name":"","type":"*","link":781,"widget":{"name":"value"}}],"outputs":[{"name":"","type":"STRING","links":[752],"slot_index":0}],"properties":{"showOutputText":false,"horizontal":false}},{"id":257,"type":"KSampler (Efficient)","pos":[1460,700],"size":{"0":330,"1":560},"flags":{},"order":25,"mode":0,"inputs":[{"name":"model","type":"MODEL","link":706,"slot_index":0,"label":"模型"},{"name":"positive","type":"CONDITIONING","link":712,"label":"正面条件"},{"name":"negative","type":"CONDITIONING","link":713,"label":"负面条件"},{"name":"latent_image","type":"LATENT","link":763,"slot_index":3,"label":"Latent"},{"name":"optional_vae","type":"VAE","link":622,"slot_index":4,"label":"VAE(可选)"},{"name":"script","type":"SCRIPT","link":null,"label":"脚本"}],"outputs":[{"name":"MODEL","type":"MODEL","links":null,"shape":3,"label":"模型"},{"name":"CONDITIONING+","type":"CONDITIONING","links":null,"shape":3,"label":"正面条件"},{"name":"CONDITIONING-","type":"CONDITIONING","links":null,"shape":3,"label":"负面条件"},{"name":"LATENT","type":"LATENT","links":null,"shape":3,"label":"Latent"},{"name":"VAE","type":"VAE","links":null,"shape":3,"label":"VAE"},{"name":"IMAGE","type":"IMAGE","links":[777],"slot_index":5,"shape":3,"label":"图像"}],"properties":{"Node name for S&R":"KSampler (Efficient)"},"widgets_values":[479266423903107,null,25,8,"dpmpp_2m_sde","karras",0.8,"none","true"],"color":"#443322","bgcolor":"#665533","shape":1},{"id":258,"type":"Reroute","pos":[200,730],"size":[75,26],"flags":{},"order":22,"mode":0,"inputs":[{"name":"","type":"*","link":773}],"outputs":[{"name":"","type":"MASK","links":[735],"slot_index":0}],"properties":{"showOutputText":false,"horizontal":false}},{"id":259,"type":"Efficient Loader","pos":[420,700],"size":[460,580],"flags":{},"order":11,"mode":0,"inputs":[{"name":"lora_stack","type":"LORA_STACK","link":null,"label":"LoRA堆"},{"name":"cnet_stack","type":"CONTROL_NET_STACK","link":null,"slot_index":1,"label":"ControlNet堆"},{"name":"positive","type":"STRING","link":752,"widget":{"name":"positive"},"label":"正面条件"},{"name":"negative","type":"STRING","link":786,"widget":{"name":"negative"},"label":"负面条件"}],"outputs":[{"name":"MODEL","type":"MODEL","links":[705],"slot_index":0,"shape":3,"label":"模型"},{"name":"CONDITIONING+","type":"CONDITIONING","links":[707],"slot_index":1,"shape":3,"label":"正面条件"},{"name":"CONDITIONING-","type":"CONDITIONING","links":[708],"slot_index":2,"shape":3,"label":"负面条件"},{"name":"LATENT","type":"LATENT","links":null,"shape":3,"label":"Latent"},{"name":"VAE","type":"VAE","links":[622,709],"slot_index":4,"shape":3,"label":"VAE"},{"name":"CLIP","type":"CLIP","links":[],"slot_index":5,"shape":3,"label":"CLIP"},{"name":"DEPENDENCIES","type":"DEPENDENCIES","links":null,"shape":3,"label":"依赖"}],"properties":{"Node name for S&R":"Efficient Loader"},"widgets_values":["sdxl/realvisxlV40_v40Bakedvae.safetensors","Baked VAE",-1,"None",1,1,"more hair","embedding:negativeXL_D.safetensors, NSFW, worst quality, low quality, illustration, 3d, 2d, cartoon, painting, cartoons, sketch, open mouth, long neck, watermark, text, extra fingers, inverted nipple, busty, large breasts, ugly, disgusting","none","comfy++",512,512,1,true,true],"color":"#332233","bgcolor":"#553355","shape":1},{"id":263,"type":"Reroute","pos":[200,660],"size":[75,26],"flags":{},"order":21,"mode":0,"inputs":[{"name":"","type":"*","link":772}],"outputs":[{"name":"","type":"IMAGE","links":[710],"slot_index":0}],"properties":{"showOutputText":false,"horizontal":false}},{"id":282,"type":"INPAINT_LoadFooocusInpaint","pos":[1010,1050],"size":{"0":315,"1":82},"flags":{},"order":0,"mode":0,"outputs":[{"name":"INPAINT_PATCH","type":"INPAINT_PATCH","links":[704],"slot_index":0,"shape":3,"label":"局部重绘组件"}],"properties":{"Node name for S&R":"INPAINT_LoadFooocusInpaint"},"widgets_values":["fooocus/fooocus_inpaint_head.pth","fooocus/inpaint_v26.fooocus.patch"]},{"id":283,"type":"INPAINT_ApplyFooocusInpaint","pos":[1060,920],"size":{"0":210,"1":66},"flags":{},"order":24,"mode":0,"inputs":[{"name":"model","type":"MODEL","link":705,"label":"模型"},{"name":"patch","type":"INPAINT_PATCH","link":704,"label":"局部重绘组件"},{"name":"latent","type":"LATENT","link":714,"label":"Latent"}],"outputs":[{"name":"MODEL","type":"MODEL","links":[706],"slot_index":0,"shape":3,"label":"模型"}],"properties":{"Node name for S&R":"INPAINT_ApplyFooocusInpaint"}},{"id":285,"type":"INPAINT_VAEEncodeInpaintConditioning","pos":[1020,750],"size":{"0":292.20001220703125,"1":106},"flags":{},"order":23,"mode":0,"inputs":[{"name":"positive","type":"CONDITIONING","link":707,"label":"正面条件"},{"name":"negative","type":"CONDITIONING","link":708,"label":"负面条件"},{"name":"vae","type":"VAE","link":709,"label":"VAE"},{"name":"pixels","type":"IMAGE","link":710,"label":"图像"},{"name":"mask","type":"MASK","link":735,"label":"遮罩"}],"outputs":[{"name":"positive","type":"CONDITIONING","links":[712],"slot_index":0,"shape":3,"label":"正面条件"},{"name":"negative","type":"CONDITIONING","links":[713],"slot_index":1,"shape":3,"label":"负面条件"},{"name":"latent_inpaint","type":"LATENT","links":[714],"slot_index":2,"shape":3,"label":"局部重绘Latent"},{"name":"latent_samples","type":"LATENT","links":[763],"slot_index":3,"shape":3,"label":"采样Latent"}],"properties":{"Node name for S&R":"INPAINT_VAEEncodeInpaintConditioning"}},{"id":292,"type":"Primitive string multiline [Crystools]","pos":[-930,320],"size":{"0":400,"1":110},"flags":{},"order":1,"mode":0,"outputs":[{"name":"string","type":"STRING","links":[781],"slot_index":0,"shape":3,"label":"字符串"}],"properties":{"Node name for S&R":"Primitive string multiline [Crystools]"},"widgets_values":["hair prompt",true]},{"id":294,"type":"GetHairInpaintMask","pos":[-470,640],"size":{"0":380,"1":214},"flags":{},"order":18,"mode":0,"inputs":[{"name":"person_image","type":"IMAGE","link":746,"label":"person_image"},{"name":"body_mask","type":"IMAGE","link":747,"label":"body_mask"},{"name":"head_mask","type":"IMAGE","link":748,"label":"head_mask"},{"name":"hair_mask","type":"IMAGE","link":749,"label":"hair_mask"}],"outputs":[{"name":"hair_inpaint_mask","type":"IMAGE","links":[750],"slot_index":0,"shape":3,"label":"hair_inpaint_mask"}],"properties":{"Node name for S&R":"GetHairInpaintMask"},"widgets_values":["ori_hair","none","",50,""]},{"id":305,"type":"InpaintCrop","pos":[-470,1090],"size":{"0":440,"1":390},"flags":{},"order":20,"mode":0,"inputs":[{"name":"image","type":"IMAGE","link":778,"label":"image"},{"name":"mask","type":"MASK","link":779,"label":"mask"},{"name":"optional_context_mask","type":"MASK","link":null,"label":"optional_context_mask"}],"outputs":[{"name":"stitch","type":"STITCH","links":[775],"slot_index":0,"shape":3,"label":"stitch"},{"name":"cropped_image","type":"IMAGE","links":[772],"slot_index":1,"shape":3,"label":"cropped_image"},{"name":"cropped_mask","type":"MASK","links":[773],"slot_index":2,"shape":3,"label":"cropped_mask"}],"properties":{"Node name for S&R":"InpaintCrop"},"widgets_values":[20,1,true,16,false,16,"bicubic","ranged size",1024,1024,1,512,512,1024,1024,32]},{"id":306,"type":"InpaintStitch","pos":[1980,700],"size":{"0":315,"1":78},"flags":{},"order":26,"mode":0,"inputs":[{"name":"stitch","type":"STITCH","link":775,"label":"stitch"},{"name":"inpainted_image","type":"IMAGE","link":777,"label":"inpainted_image"}],"outputs":[{"name":"image","type":"IMAGE","links":[783],"slot_index":0,"shape":3,"label":"image"}],"properties":{"Node name for S&R":"InpaintStitch"},"widgets_values":["bislerp"]},{"id":307,"type":"Load Image From Url","pos":[-2370,580],"size":{"0":400,"1":200},"flags":{},"order":2,"mode":0,"outputs":[{"name":"IMAGE","type":"IMAGE","links":[782],"slot_index":0,"shape":3,"label":"IMAGE"},{"name":"MASK","type":"MASK","links":null,"shape":3,"label":"MASK"}],"properties":{"Node name for S&R":"Load Image From Url"},"widgets_values":["face",true]},{"id":309,"type":"Save Image To OSS And Display","pos":[2470,700],"size":{"0":315,"1":82},"flags":{},"order":27,"mode":0,"inputs":[{"name":"images","type":"IMAGE","link":783,"label":"images"}],"properties":{"Node name for S&R":"Save Image To OSS And Display"},"widgets_values":["comfyui","JPEG"]},{"id":310,"type":"Primitive string multiline [Crystools]","pos":[-430,310],"size":{"0":450,"1":120},"flags":{"collapsed":false},"order":4,"mode":0,"outputs":[{"name":"string","type":"STRING","links":[785],"slot_index":0,"shape":3,"label":"字符串"}],"properties":{"Node name for S&R":"Primitive string multiline [Crystools]"},"widgets_values":["negative",true]},{"id":311,"type":"Primitive string multiline [Crystools]","pos":[100,300],"size":{"0":450,"1":120},"flags":{"collapsed":false},"order":3,"mode":0,"outputs":[{"name":"string","type":"STRING","links":[784],"slot_index":0,"shape":3,"label":"字符串"}],"properties":{"Node name for S&R":"Primitive string multiline [Crystools]"},"widgets_values":["embedding:negativeXL_D.safetensors, NSFW, worst quality, low quality, illustration, 3d, 2d, cartoon, painting, cartoons, sketch, open mouth, long neck, watermark, text, extra fingers, inverted nipple, busty, large breasts, ugly, disgusting",true]},{"id":312,"type":"JoinStrings","pos":[610,310],"size":[315,106],"flags":{},"order":7,"mode":0,"inputs":[{"name":"string1","type":"STRING","link":784,"widget":{"name":"string1"}},{"name":"string2","type":"STRING","link":785,"widget":{"name":"string2"}}],"outputs":[{"name":"STRING","type":"STRING","links":[786],"shape":3,"label":"字符串","slot_index":0}],"properties":{"Node name for S&R":"JoinStrings"},"widgets_values":["","",","]}],"links":[[477,128,0,208,0,"IMAGE"],[481,128,0,211,0,"IMAGE"],[488,216,0,210,0,"MASK"],[489,208,1,216,0,"MASK"],[490,211,1,217,0,"MASK"],[491,217,0,218,0,"MASK"],[499,221,0,222,0,"MASK"],[500,220,1,221,0,"MASK"],[501,128,0,220,0,"IMAGE"],[622,259,4,257,4,"VAE"],[704,282,0,283,1,"INPAINT_PATCH"],[705,259,0,283,0,"MODEL"],[706,283,0,257,0,"MODEL"],[707,259,1,285,0,"CONDITIONING"],[708,259,2,285,1,"CONDITIONING"],[709,259,4,285,2,"VAE"],[710,263,0,285,3,"IMAGE"],[712,285,0,257,1,"CONDITIONING"],[713,285,1,257,2,"CONDITIONING"],[714,285,2,283,2,"LATENT"],[735,258,0,285,4,"MASK"],[746,128,0,294,0,"IMAGE"],[747,222,0,294,1,"IMAGE"],[748,210,0,294,2,"IMAGE"],[749,218,0,294,3,"IMAGE"],[750,294,0,191,0,"IMAGE"],[752,256,0,259,2,"STRING"],[763,285,3,257,3,"LATENT"],[772,305,1,263,0,"*"],[773,305,2,258,0,"*"],[775,305,0,306,0,"STITCH"],[777,257,5,306,1,"IMAGE"],[778,128,0,305,0,"IMAGE"],[779,191,0,305,1,"MASK"],[781,292,0,256,0,"*"],[782,307,0,128,0,"*"],[783,306,0,309,0,"IMAGE"],[784,311,0,312,0,"STRING"],[785,310,0,312,1,"STRING"],[786,312,0,259,3,"STRING"]],"groups":[{"title":"头发mask区域绘制","bounding":[-1730,510,1750,1560],"color":"#3f789e","font_size":24,"locked":false},{"title":"sd1.5-brushnet","bounding":[240,530,1616,813],"color":"#3f789e","font_size":24,"locked":false}],"config":{},"extra":{"ds":{"scale":0.611590904484169,"offset":[665.7984277169364,39.41737006156666]},"0246.VERSION":[0,0,4],"workspace_info":{"id":"KO_9fnK1aFpC9UEBC6Ibj","saveLock":false,"cloudID":null,"coverMediaPath":null}},"version":0.4}